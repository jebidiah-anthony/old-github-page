<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="/assets/css/style.css?v=">
    
        

    <meta name="twitter:card" content="summary_large_image"/>
    <meta name="twitter:title" content="jebidiah-anthony">
    <meta name="twitter:description" content="">
    <meta name="twitter:site" content="@jebidiah-anthony" />
    <meta name="twitter:creator" content="@feeeellliix">
    <meta name="twitter:card" content="summary">

    
    <meta property="og:image" content="http://localhost:4000/banner.jpg" />
    

    

    <!-- Begin Jekyll SEO tag v2.6.1 -->
<title>jebidiah-anthony</title>
<meta name="generator" content="Jekyll v4.0.0" />
<meta property="og:title" content="jebidiah-anthony" />
<meta property="og:locale" content="en_US" />
<link rel="canonical" href="http://localhost:4000/chals/ctf/2019_NACTF/crypto/3_Group_Test_Randomizer_0.html" />
<meta property="og:url" content="http://localhost:4000/chals/ctf/2019_NACTF/crypto/3_Group_Test_Randomizer_0.html" />
<meta property="og:site_name" content="jebidiah-anthony" />
<script type="application/ld+json">
{"@type":"WebPage","url":"http://localhost:4000/chals/ctf/2019_NACTF/crypto/3_Group_Test_Randomizer_0.html","headline":"jebidiah-anthony","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->


    <style>
      header { margin-bottom: 0px; }
      .header .navbtn {
	position: fixed;
	width: 0px;
	visibility: hidden;
      }
      .header .title { 
	padding-left: 69px;
	vertical-align: middle;
      }
      .header .title h2 { margin: 0; } 

      .container {
	max-width: 1200px;
      }
      .sidebar {
        border-right: 1px dashed #b5e853;
	bottom: 0;
        height: 100%;
	overflow: auto;
	padding: 10px 10px 10px 10px;
        position: fixed;
	top: 0;
        width: 230px;
      }
      .openbtn { 
	color:#b5e853;
	font-size:30px;
	cursor:pointer
      }
      .closebtn {
	color:#b5e853;
	font-size:69px;
	cursor:pointer;
	position:absolute;
	top:0;
	right:25px;
	font-size:36px;
	margin-left:50px;
	visibility:hidden;
      }
      
      .ctf_content {
        margin-left: 250px;
	padding-bottom: 5px;
      }
      .ctf_content h2 {	padding: 20px 0px 0px 10px; }
      .ctf_content h3 { margin: 20px 0px 0px 10px; }
      .ctf_content img {
	max-width: 100%;
	padding: 0 10px 0 0;
      }
      .ctf_content table { padding: 0 15px; }

      #main_content h1 { padding: 20px 0px 0px 8px; }
      #main_content h2, p, pre { 
	padding-right:10px;
	padding-left:15px; 
      }
      #main_content h4 { 
        margin: 20px 0px 10px 0px; 
        padding-left: 25px; 
      }
      #main_content ol, ul { margin: 0 0 0 10px; }

      .highlighter-rouge { padding: 0 10px 0 10px; }

      .section-divider{
        border-bottom: 1.5px solid #b5e853;
        padding-top:28px;
        width:55%;
      }
      
      @media screen and (min-width: 801px) {
	.ctf_content {
          margin-left: 250px;
	  padding-bottom: 5px;
        }
      }
      @media screen and (max-width: 800px) {
        header {
	  background-color: #202020;
	  height: 80px;
	  padding: 0px 0 0 0;
	  position: fixed;
	  top: 0;
	}
        .header .navbtn {
          height: 80px;
	  padding: 18px 0 0 20px;
          visibility: visible;
	  width: 100px;
        }
	.header .title { padding-left: 100px; }
	.header .title h1 { padding-top: 5px; }
        .header .title h2 { margin: 0; }

	.container {
	  width:100%;
	}
	.sidebar {
          width: 0;
          z-index: 1;
          overflow-x: hidden;
	  padding: 0;
          transition: 0.5s;
	}
	.sidebar h2 { 
	  font-size: 18px; 
	  padding: 10px 10px 5px 10px;
	}
	.sidebar div { 
	  font-size: 15px; 
	  padding: 5px 10px 5px 10px;
	}
	.closebtn { visibility:visible; }

	.highlighter-rouge { padding: 0 0 0 0; }

	.ctf_content {
	  margin: 0;
	}
	.ctf_content h2 { padding: 15px 0px 0px 5px; }
        .ctf_content h3 { margin: 15px 10px 0px 15px; }
        .ctf_content img {
	  max-width: 100%;
	  padding: 0 10px 0 0;
        }
	.ctf_content table { 
	  margin: 0 10px 0px -8px;
	  min-width: 800px;
	}

        #main_content { margin-top:80px; }
	#main_content code { font-size: 15px; }
	#main_content h1 { font-size: 25px; }
	#main_content h2 { font-size: 22px; }
	#main_content h3 { font-size: 18px; }
	#main_content h4 { padding-left: 20px; }
	#main_content ol, ul {
	  font-size: 14px;
	  margin: 0 0 0 12px;
	  padding: 0 0 0 25px;
	}
	#main_content table { font-size: 14px; }
      }

      @media screen and (max-width: 480px) {
        header {
	  background-color: #202020;
	  height: 70px;
	  padding: 0px 0 0 0;
	  position: fixed;
	  top: 0;
	}
        .header .navbtn {
          height: 70px;
	  padding: 14px 0 0 18px;
        }
	.header .title { padding-left: 100px; }
	.header .title h1 { font-size:22px; }
        .header .title h2 { font-size:16px; }

	#main_content code { font-size: 13px; }
        #main_content ol, ul {
	  font-size: 13px;
	  margin: 0 0 0 12px;
	  padding: 0 0 0 25px;
	}
	#main_content table { font-size: 13px; }
      }
    </style>

  </head>

  <body>
    <div class="container">
       <div id="sidebar" class="sidebar">
         <span class="closebtn" onclick="closeNav()">&times;</span>      
	 <div><h2 style="margin-bottom:0; padding-top:20px">[SITE PAGES]</h2>

<div style="padding-top:10px">
  
  > <a href="/">whoami</a>
  
</div>
<div style="padding-top:10px">  
  >  <a href="/htb.html">
    
    htb writeups
    
  </a>
</div>
<div style="padding-top:10px">
  > <a href="/ctf.html">
    
    <strong style="color:orange">ctf writeups</strong>
    
  </a>
</div>
<div style="padding-top:10px">
  > <a href="/projects.html">
    
    projects
    
  </a>
</div>
</div>
	 <div style="padding-bottom:20px">
           
	     <h2 style="margin-bottom:0; padding-top: 20px">[HTB CHALLENGES]</h2>


<div style="padding-top:10px">
  > <a href="http://localhost:4000/chals/htb/challenges.html#for">
  
  Forensics
  
  </a>
</div>

<div style="padding-top:10px">
  > <a href="http://localhost:4000/chals/htb/challenges.html#mob">
  
  Mobile
  
  </a>
</div>

<div style="padding-top:10px">
  > <a href="http://localhost:4000/chals/htb/challenges.html#pwn">
  
  Pwn
  
  </a>
</div>

<div style="padding-top:10px">
  > <a href="http://localhost:4000/chals/htb/challenges.html#web">
  
  Web
  
  </a>
</div>



             <h2 style="margin-bottom:0; padding-top:20px">[CTF EVENTS]</h2>


<div style="padding-top:10px">
  > <a href="http://localhost:4000/chals/ctf/2019-XMASCTF.html">
  
  X-MAS CTF 2019
  
  </a>
</div>

<div style="padding-top:10px">
  > <a href="http://localhost:4000/chals/ctf/2019-CyberSEAGame.html">
  
  Cyber SEA Game 2019
  
  </a>
</div>

<div style="padding-top:10px">
  > <a href="http://localhost:4000/chals/ctf/2019-NACTF.html">
  
  <strong style="color:orange;text-decoration:none">NACTF 2019</strong>
  
  </a>
</div>

<div style="padding-top:10px">
  > <a href="http://localhost:4000/chals/ctf/2019-TGHack.html">
  
  TG:Hack 2019
  
  </a>
</div>

<div style="padding-top:10px">
  > <a href="http://localhost:4000/chals/ctf/2019-TJCTF.html">
  
  TJCTF 2019
  
  </a>
</div>


	   
	 </div>
       </div>
       <div id="content" class="ctf_content">
	 <header>
           <div class="header">
             <div class="navbtn">
               <span class="openbtn" onclick="openNav()">&#9776;</span>
	     </div>
	     <div class="title">
               <h1>jebidiah-anthony</h1>
               <h2 style="padding:0 0 0 0">write-ups and what not</h2>
	     </div>
           </div>
         </header>
         <section id="main_content"><h2 id="dr-js-group-test-randomizer-0"><span style="color:red">Dr. J’s Group Test Randomizer #0</span></h2>

<hr />

<h3 id="part-1--challenge-description">PART 1 : CHALLENGE DESCRIPTION</h3>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Dr. J created a fast pseudorandom number generator (prng) to 
randomly assign pairs for the upcoming group test. Leaf really wants 
to know the pairs ahead of time... can you help him and predict the 
next output of Dr. J's prng? Leaf is pretty sure that Dr. J is using 
the middle-square method.

nc shell.2019.nactf.com 31425

The server is running the code in class-randomizer-0.c. Look at the 
function nextRand() to see how numbers are being generated!
</code></pre></div></div>

<hr />

<h3 id="part-2--given-files">PART 2 : GIVEN FILES</h3>

<h4 id="-class-randomizer-0c"><strong>[&gt;]</strong> <a href="./files/class-randomizer-0.c">class-randomizer-0.c</a></h4>

<hr />

<h3 id="part-3--program-flow">PART 3 : PROGRAM FLOW</h3>

<ol>
  <li>A seed is initialized:
    <div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">uint64_t</span> <span class="n">seed</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

<span class="kt">void</span> <span class="nf">init_seed</span><span class="p">()</span> <span class="p">{</span>
  <span class="kt">uint64_t</span> <span class="n">r1</span> <span class="o">=</span> <span class="p">(</span><span class="kt">uint64_t</span><span class="p">)</span> <span class="n">randombytes_random</span><span class="p">();</span>
  <span class="kt">uint64_t</span> <span class="n">r2</span> <span class="o">=</span> <span class="p">(</span><span class="kt">uint64_t</span><span class="p">)</span> <span class="n">randombytes_random</span><span class="p">();</span>
  <span class="n">seed</span> <span class="o">=</span> <span class="p">(</span><span class="n">r1</span> <span class="o">&lt;&lt;</span> <span class="mi">32</span><span class="p">)</span> <span class="o">+</span> <span class="n">r2</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>    </div>
    <p><strong>NOTE(S)</strong>:</p>
    <ol>
      <li>The generated seed has a maximum value of <strong><code class="highlighter-rouge">0xffffffff</code></strong>.</li>
    </ol>
  </li>
  <li>An actions menu is presented to the user:
    <div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">printf</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">Welcome to Dr. J's Random Number Generator v1! </span><span class="se">\n</span><span class="s">"</span>
<span class="s">"[r] Print a new random number </span><span class="se">\n</span><span class="s">"</span>
<span class="s">"[g] Guess the next two random numbers and receive the flag! </span><span class="se">\n</span><span class="s">"</span>
<span class="s">"[q] Quit </span><span class="se">\n\n</span><span class="s">"</span><span class="p">);</span>
</code></pre></div>    </div>
    <ol>
      <li><strong><code class="highlighter-rouge">[r]</code></strong> generates a new random number:
        <div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">uint64_t</span> <span class="nf">nextRand</span><span class="p">()</span> <span class="p">{</span>
  <span class="c1">// Keep the 8 middle digits from 5 to 12 (inclusive) and square.</span>
  <span class="n">seed</span> <span class="o">=</span> <span class="n">getDigits</span><span class="p">(</span><span class="n">seed</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">12</span><span class="p">);</span>
  <span class="n">seed</span> <span class="o">*=</span> <span class="n">seed</span><span class="p">;</span>
  <span class="k">return</span> <span class="n">seed</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>        </div>
        <p><strong>NOTE(S)</strong>:</p>
        <ol>
          <li>The <strong>5th</strong> to the <strong>8th</strong> digits from the right of the seed is squared.</li>
          <li>The squared number is now the new seed.</li>
        </ol>
      </li>
      <li>
        <p><strong><code class="highlighter-rouge">[g]</code></strong> lets the user guess the next two “random” numbers to get the flag.</p>
      </li>
      <li><strong><code class="highlighter-rouge">[q]</code></strong> lets the user exit the program.</li>
    </ol>
  </li>
</ol>

<hr />

<h3 id="part-4--getting-the-flag">PART 4 : GETTING THE FLAG</h3>

<ol>
  <li>Run the program:
    <div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span><span class="w"> </span>nc shell.2019.nactf.com 31425
<span class="go">
  Welcome to Dr. J's Random Number Generator v1! 
  [r] Print a new random number 
  [g] Guess the next two random numbers and receive the flag! 
  [q] Quit 

</span><span class="gp">$</span><span class="w"> </span><span class="o">&gt;</span> r
<span class="go">  5339808891408016
</span><span class="gp">$</span><span class="w"> </span><span class="o">&gt;</span> g
<span class="go">
  Guess the next two random numbers for a flag! You have a 0.0000000000000000000000000000001% chance of guessing both correctly... Good luck!
  Enter your first guess:
</span><span class="gp">$</span><span class="w"> </span><span class="o">&gt;</span> 6543052969939600
<span class="go">
  Wow, lucky guess... You won't be able to guess right a second time.
  Enter your second guess:
</span><span class="gp">$</span><span class="w"> </span><span class="o">&gt;</span> 28058134842049
<span class="go">
  What? You must have psychic powers... Well here's your flag: nactf{1_l0v3_chunky_7urn1p5}
</span></code></pre></div>    </div>
    <p><strong>NOTE(S)</strong>:</p>
    <ol>
      <li>The vulnerability lies with the fact that the current seed is output as the “random” number generated”</li>
      <li>That and the fact that the next seed is just the square of 8 middle digits from the current seed.</li>
      <li>Generating the next “random” numbers using the <code class="highlighter-rouge">python3</code> console:
        <div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="n">curr</span> <span class="o">=</span> <span class="mi">5339808891408016</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">curr</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">curr</span><span class="p">)[</span><span class="o">-</span><span class="mi">12</span><span class="p">:</span><span class="o">-</span><span class="mi">4</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">curr</span>
<span class="mi">6543052969939600</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">curr</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">curr</span><span class="p">)[</span><span class="o">-</span><span class="mi">12</span><span class="p">:</span><span class="o">-</span><span class="mi">4</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">curr</span>
<span class="mi">28058134842049</span>
</code></pre></div>        </div>
      </li>
    </ol>
  </li>
</ol>

<hr />

<h2 id="flag--nactf1_l0v3_chunky_7urn1p5">FLAG : <strong>nactf{1_l0v3_chunky_7urn1p5}</strong></h2>
</section>
       </div>
    </div>

    <script>
      function openNav() {
        document.getElementById("sidebar").style.width = "250px";
        document.getElementById("content").style.marginLeft = "250px";
      }
      function closeNav() {
        document.getElementById("sidebar").removeAttribute("style");
        document.getElementById("content").removeAttribute("style");
      } 
    </script>

    
      <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
        ga('create', 'true', 'auto');
        ga('send', 'pageview');
      </script>
    
  </body>
</html>
